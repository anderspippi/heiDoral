//= vm-args "--gc=swiper --gc-verify"

class Foo(let x: Int32)

fun main() {
    let x = Array[Foo](64);
    forceMinorCollect();
    assert(x(0) === nil);
    assert(x(63) === nil);

    x(0) = Foo(1I);
    forceMinorCollect();
    assert(x(0).x == 1I);
    assert(x(63) === nil);

    x(63) = Foo(2I);
    forceMinorCollect();
    assert(x(0).x == 1I);
    assert(x(63).x == 2I);

    forceMinorCollect();
    assert(x(0).x == 1I);
    assert(x(63).x == 2I);
}
