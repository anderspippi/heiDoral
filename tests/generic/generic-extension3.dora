//= stdout "self=Foo:1 another=Int32:101\nself=Int32:2 another=Float32:102\n"

class MyClass[T](let value: Int32)
class Foo

impl[X: TypeDescriptor] MyClass[X] {
    fn do[T: TypeDescriptor](another: MyClass[T]) {
        println("self=${X::name()}:${self.value} another=${T::name()}:${another.value}");
    }
}

trait TypeDescriptor {
    @static fn name(): String;
}

impl TypeDescriptor for Foo {
    @static fn name(): String { "Foo" }
}

impl TypeDescriptor for Int32 {
    @static fn name(): String { "Int32" }
}

impl TypeDescriptor for Float32 {
    @static fn name(): String { "Float32" }
}

fn f() {
    MyClass[Foo](1I).do[Int32](MyClass[Int32](101I));
    MyClass[Int32](2I).do[Float32](MyClass[Float32](102I));
}

fn main() {
    f();
}
