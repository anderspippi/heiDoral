//= vm-args "--gc=swiper --max-heap-size=128M"

class Foo (let value: Int32)

fun main() {
    let x = Array[(Int32, Foo)](32);
    forceMinorCollect();
    forceMinorCollect();
    for i in range(0I, x.length().toInt32()) {
        x(i.toInt()) = (i, Foo(i));
    }
    forceMinorCollect();
    for i in range(0I, x.length().toInt32()) {
        assert(x(i.toInt()).0 == i && x(i.toInt()).0 == x(i.toInt()).1.value);
    }
}